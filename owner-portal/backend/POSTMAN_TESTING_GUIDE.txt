================================================================================
                          OWNER PORTAL - POSTMAN TESTING GUIDE
                                    CORRECTED VERSION
================================================================================

BASE URL: http://localhost:5000
Content-Type: application/json

================================================================================
1. AUTHENTICATION ENDPOINTS
================================================================================

1.1 SIGNUP
-----------
Method: POST
URL: http://localhost:5000/auth/signup
Headers:
  Content-Type: application/json
Body (JSON):
{
  "name": "John Doe",
  "email": "john.doe@example.com",
  "password": "password123",
  "role": "owner"
}

1.2 LOGIN
---------
Method: POST
URL: http://localhost:5000/auth/login
Headers:
  Content-Type: application/json
Body (JSON):
{
  "email": "krprateek758@gmail.com",
  "password": "Prateek@289"
}

1.3 GET USER INFO
-----------------
Method: GET
URL: http://localhost:5000/auth/me
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

NOTE: Save the token from login response - you'll need it for all authenticated requests below.

================================================================================
2. AUTHENTICATED REQUESTS SETUP
================================================================================

For all endpoints below, add this header:
Authorization: Bearer YOUR_TOKEN_HERE

Replace YOUR_TOKEN_HERE with the actual token from login response.

================================================================================
3. BOOKING ENDPOINTS
================================================================================

3.1 GET BOOKINGS BY PROPERTY
-----------------------------
Method: GET
URL: http://localhost:5000/bookings/{listingId}
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/bookings/392776
http://localhost:5000/bookings/392777
http://localhost:5000/bookings/392778

Query Parameters (optional):
?startDate=2025-01-01&endDate=2025-12-31

Full URL with params:
http://localhost:5000/bookings/392776?startDate=2025-01-01&endDate=2025-12-31

================================================================================
4. INVOICE ENDPOINTS
================================================================================

4.1 GET INVOICES BY PROPERTY
-----------------------------
Method: GET
URL: http://localhost:5000/invoices/{listingId}
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/invoices/392776
http://localhost:5000/invoices/392777
http://localhost:5000/invoices/392778

Query Parameters (optional):
?startDate=2025-01-01&endDate=2025-12-31

4.2 GET INVOICE DEBUG
---------------------
Method: GET
URL: http://localhost:5000/invoices/{listingId}/debug
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/invoices/392776/debug
http://localhost:5000/invoices/392777/debug
http://localhost:5000/invoices/392778/debug

================================================================================
5. TOURIST TAX ENDPOINTS
================================================================================

5.1 GET TOURIST TAX SUMMARY
----------------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/tourist-tax
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/tourist-tax
http://localhost:5000/properties/392777/tourist-tax
http://localhost:5000/properties/392778/tourist-tax

Query Parameters:
?startDate=2025-07-01&endDate=2025-07-31

Full URL:
http://localhost:5000/properties/392776/tourist-tax?startDate=2025-07-01&endDate=2025-07-31

5.2 GET TOURIST TAX DETAILED
-----------------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/tourist-tax/detailed
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/tourist-tax/detailed?startDate=2025-07-01&endDate=2025-07-31
http://localhost:5000/properties/392777/tourist-tax/detailed?startDate=2025-07-01&endDate=2025-07-31
http://localhost:5000/properties/392778/tourist-tax/detailed?startDate=2025-07-01&endDate=2025-07-31

5.3 GET TOURIST TAX DEBUG
--------------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/tourist-tax/debug
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/tourist-tax/debug?startDate=2025-07-01&endDate=2025-07-31
http://localhost:5000/properties/392777/tourist-tax/debug?startDate=2025-07-01&endDate=2025-07-31
http://localhost:5000/properties/392778/tourist-tax/debug?startDate=2025-07-01&endDate=2025-07-31

================================================================================
6. SIBA COMPLIANCE ENDPOINTS
================================================================================

6.1 GET SIBA STATUS
-------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/siba-status
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/siba-status
http://localhost:5000/properties/392777/siba-status
image.png

6.2 GET SIBA DEBUG
------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/siba/debug
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/siba/debug
http://localhost:5000/properties/392777/siba/debug
http://localhost:5000/properties/392778/siba/debug

6.3 SEND SIBA (POST)
--------------------
Method: POST
URL: http://localhost:5000/properties/{propertyId}/siba/send
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json
Body (JSON):
{
  "reservationId": "RESERVATION_ID_HERE"
}

6.4 VALIDATE SIBA
-----------------
Method: GET
URL: http://localhost:5000/properties/siba/validate/{reservationId}
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

6.5 BULK SIBA STATUS
--------------------
Method: POST
URL: http://localhost:5000/properties/siba/bulk-status
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json
Body (JSON):
{
  "propertyIds": [392776, 392777, 392778]
}

6.6 SIBA LOGS
-------------
Method: GET
URL: http://localhost:5000/properties/siba/logs/{reservationId}
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

================================================================================
7. PROPERTY ENDPOINTS (ALTERNATIVE ROUTES)
================================================================================

7.1 GET PROPERTY INVOICES
--------------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/invoices
Headers:
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/invoices
http://localhost:5000/properties/392777/invoices
http://localhost:5000/properties/392778/invoices

7.2 GET PROPERTY PERFORMANCE
----------------------------
Method: GET
URL: http://localhost:5000/properties/{propertyId}/performance
Headers:
  Content-Type: application/json

Examples:
http://localhost:5000/properties/392776/performance
http://localhost:5000/properties/392777/performance
http://localhost:5000/properties/392778/performance

================================================================================
8. PERFORMANCE ENDPOINTS
================================================================================

8.1 GET PERFORMANCE METRICS
----------------------------
Method: GET
URL: http://localhost:5000/performance/{listingId}
Headers:
  Authorization: Bearer YOUR_TOKEN_HERE
  Content-Type: application/json

Query Parameters:
?month=2025-07

Examples:
http://localhost:5000/performance/392776?month=2025-07
http://localhost:5000/performance/392777?month=2025-07
http://localhost:5000/performance/392778?month=2025-07

================================================================================
9. HEALTH CHECK ENDPOINTS
================================================================================

9.1 HEALTH CHECK
----------------
Method: GET
URL: http://localhost:5000/health
Headers:
  Content-Type: application/json

No authentication required.

================================================================================
10. TEST PROPERTY IDS (UPDATED)
================================================================================

✅ WORKING PROPERTY IDS (Available in Hostaway):
- 392776 (Come Home to Calm in Lisbon's Center)
- 392777 (Algarve Seaside Lux Apartment w/Pool)
- 392778 (Upscale Condominium on Edge of Old Fishing Village)
- 392779 (Algarve Ocean Tri-View Luxury Apartment w/Pool)
- 392780 (Algarve Oceanfront Luxury Apartment w/Pool)
- 392781 (Marina Village Oceanside Apartment w/Pool)
- 414661 (Waterfront Pool Penthouse View)
- 425286 (Classic Apt + Pool Near Strip)

❌ REMOVED PROPERTY IDS (Not available in Hostaway):
- 392782 (Property doesn't exist in your Hostaway account)

================================================================================
11. WORKING SAMPLE URLS (COPY-PASTE READY)
================================================================================

# Authentication
POST http://localhost:5000/auth/login
POST http://localhost:5000/auth/signup
GET http://localhost:5000/auth/me

# Bookings  
GET http://localhost:5000/bookings/392776
GET http://localhost:5000/bookings/392777
GET http://localhost:5000/bookings/392778

# Invoices
GET http://localhost:5000/invoices/392776
GET http://localhost:5000/invoices/392776/debug
GET http://localhost:5000/invoices/392777
GET http://localhost:5000/invoices/392777/debug

# Tourist Tax
GET http://localhost:5000/properties/392776/tourist-tax?startDate=2025-07-01&endDate=2025-07-31
GET http://localhost:5000/properties/392776/tourist-tax/detailed?startDate=2025-07-01&endDate=2025-07-31
GET http://localhost:5000/properties/392776/tourist-tax/debug?startDate=2025-07-01&endDate=2025-07-31

# SIBA
GET http://localhost:5000/properties/392776/siba-status
GET http://localhost:5000/properties/392776/siba/debug
GET http://localhost:5000/properties/392777/siba-status
GET http://localhost:5000/properties/392778/siba-status

# Performance
GET http://localhost:5000/performance/392776?month=2025-07
GET http://localhost:5000/performance/392777?month=2025-07

# Property Alternative Routes
GET http://localhost:5000/properties/392776/invoices
GET http://localhost:5000/properties/392776/performance

# Health Check
GET http://localhost:5000/health

================================================================================
12. CORRECTED TEST FLOW
================================================================================

1. First, test login to get a token:
   POST http://localhost:5000/auth/login

2. Test health check (no auth required):
   GET http://localhost:5000/health

3. Test bookings for each property:
   GET http://localhost:5000/bookings/392776
   GET http://localhost:5000/bookings/392777  
   GET http://localhost:5000/bookings/392778
   GET http://localhost:5000/bookings/392779
   GET http://localhost:5000/bookings/392780
   GET http://localhost:5000/bookings/392781
   GET http://localhost:5000/bookings/414661
   GET http://localhost:5000/bookings/425286

4. Test invoices with debug:
   GET http://localhost:5000/invoices/392776
   GET http://localhost:5000/invoices/392776/debug

5. Test tourist tax (all variations):
   GET http://localhost:5000/properties/392776/tourist-tax?startDate=2025-07-01&endDate=2025-07-31
   GET http://localhost:5000/properties/392776/tourist-tax/detailed?startDate=2025-07-01&endDate=2025-07-31
   GET http://localhost:5000/properties/392776/tourist-tax/debug?startDate=2025-07-01&endDate=2025-07-31

6. Test SIBA status for each property:
   GET http://localhost:5000/properties/392776/siba-status
   GET http://localhost:5000/properties/392777/siba-status
   GET http://localhost:5000/properties/392778/siba-status

7. Test performance metrics:
   GET http://localhost:5000/performance/392776?month=2025-07

================================================================================
13. AUTHENTICATION HEADER FOR ALL PROTECTED ROUTES
================================================================================

After login, add this header to ALL requests (except /health and property routes):
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.YOUR_ACTUAL_TOKEN_HERE

Example login response:
{
  "message": "Login successful",
  "user": {...},
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.YOUR_ACTUAL_TOKEN_HERE"
}

Copy the token value and use it in Authorization header.

================================================================================
14. ROUTES THAT DON'T NEED AUTHENTICATION
================================================================================

These routes work without Authorization header:
- GET http://localhost:5000/health
- GET http://localhost:5000/properties/{propertyId}/invoices  
- GET http://localhost:5000/properties/{propertyId}/performance

================================================================================
15. ROUTES THAT REQUIRE AUTHENTICATION
================================================================================

These routes REQUIRE Authorization header:
- All /auth/ routes (except signup/login)
- All /bookings/ routes
- All /invoices/ routes  
- All /properties/{id}/tourist-tax routes
- All /properties/{id}/siba-status routes
- All /performance/ routes

================================================================================

🔍 DEBUG ENDPOINTS FOR PROPERTY CONFIGURATION:

1. List All Available Hostaway Properties:
   URL: http://localhost:5000/bookings/debug/hostaway/properties
   Method: GET
   Headers: Authorization: Bearer YOUR_JWT_TOKEN
   Description: Lists all properties available in your Hostaway account

2. Test Property API Keys Configuration:
   URL: http://localhost:5000/bookings/debug/property/{propertyId}
   Method: GET
   Headers: Authorization: Bearer YOUR_JWT_TOKEN
   
   Working Properties (copy-paste ready):
   - Property 392776: http://localhost:5000/bookings/debug/property/392776
   - Property 392777: http://localhost:5000/bookings/debug/property/392777
   - Property 392778: http://localhost:5000/bookings/debug/property/392778
   - Property 392779: http://localhost:5000/bookings/debug/property/392779
   - Property 392780: http://localhost:5000/bookings/debug/property/392780
   - Property 392781: http://localhost:5000/bookings/debug/property/392781
   - Property 414661: http://localhost:5000/bookings/debug/property/414661
   - Property 425286: http://localhost:5000/bookings/debug/property/425286

3. Test Booking Fetching for New Properties:
   - NEW Property 414661: http://localhost:5000/bookings/414661
   - NEW Property 425286: http://localhost:5000/bookings/425286

================================================================================
END OF CORRECTED GUIDE
================================================================================